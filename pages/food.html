<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food & Drink - Girton Feast</title>

    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="../images/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../images/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../images/favicons/favicon-16x16.png">
    <link rel="manifest" href="../images/favicons/site.webmanifest">
    <link rel="shortcut icon" href="../images/favicons/favicon.ico">

    <!-- Bootstrap CSS from CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Google Fonts: Sigmar One and Poppins -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sigmar+One&family=Poppins:wght@400;700&display=swap"
        rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <!-- Alpine.js -->
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../css/style.css">
</head>

<body class="bg-light" x-data x-on:keydown.window="$store.app.handleKonami($event.key)">

    <!-- Placeholder for the navigation bar -->
    <div id="navbar-placeholder"></div>

    <main class="container my-5" 
          x-data="{ 
            vendors: [], 
            selectedDiet: 'all',
            get uniqueDiets() {
                return [...new Set(this.vendors.flatMap(v => v.tags))].sort();
            },
            get filteredVendors() {
                if (this.selectedDiet === 'all') return this.vendors;
                return this.vendors.filter(v => v.tags.includes(this.selectedDiet));
            }
          }"
          x-init="vendors = await (await fetch('../vendors.json')).json()">
        <!-- Header -->
        <div class="text-center pt-5 mb-5">
            <h1 class="display-4" style="font-family: 'Sigmar One', cursive; color: var(--brand-marian-blue);">Food &
                Drink</h1>
            <p class="lead text-muted">Explore the delicious food and refreshing drinks available at the Feast.</p>
        </div>

        <!-- Dietary Filter Section -->
        <div class="filter-section bg-white p-4 rounded-4 mb-5 shadow-sm sticky-top" style="z-index: 1020;">
            <div class="d-flex justify-content-between align-items-center cursor-pointer" data-bs-toggle="collapse"
                data-bs-target="#dietary-filters-collapse" aria-expanded="false"
                aria-controls="dietary-filters-collapse">
                <h5 class="fw-bold mb-0" style="color: var(--brand-marian-blue);">
                    <i class="fas fa-filter me-2 small"></i>Filters
                </h5>
                <i class="fas fa-chevron-down filter-chevron transition-300"></i>
            </div>
            <div class="collapse" id="dietary-filters-collapse">
                <div id="dietary-filters" class="d-flex flex-wrap gap-2 mt-3">
                    <button class="btn btn-sm rounded-pill px-3 transition-200"
                            :class="selectedDiet === 'all' ? 'btn-brand-marian-blue text-white shadow-sm' : 'btn-outline-secondary opacity-75'"
                            @click="selectedDiet = 'all'">
                        All
                    </button>
                    <template x-for="diet in uniqueDiets">
                        <button class="btn btn-sm rounded-pill px-3 transition-200 text-capitalize"
                                :class="selectedDiet === diet ? 'btn-brand-marian-blue text-white shadow-sm' : 'btn-outline-secondary opacity-75'"
                                @click="selectedDiet = diet"
                                x-text="diet.replace(/-/g, ' ')">
                        </button>
                    </template>
                </div>
            </div>
        </div>

        <div id="vendor-container" class="row g-4">
            <template x-for="vendor in filteredVendors">
                <div class="col-md-6 col-lg-4">
                    <div class="card h-100 border-0 shadow-sm hover-lift overflow-hidden rounded-4">
                        <a :href="vendor.url !== '#' ? vendor.url : 'javascript:void(0)'" 
                           :target="vendor.url.startsWith('http') ? '_blank' : '_self'"
                           class="text-decoration-none h-100 d-flex flex-column">
                            <div class="position-relative overflow-hidden" style="aspect-ratio: 16/9;">
                                <img :src="'../' + vendor.image" 
                                     class="card-img-top w-100 h-100 object-cover transition-500" 
                                     :alt="vendor.name">
                            </div>
                            <div class="card-body p-4 d-flex flex-column">
                                <h5 class="card-title fw-bold mb-3" style="color: var(--brand-marian-blue);" x-text="vendor.name"></h5>
                                <div class="mt-auto d-flex flex-wrap gap-2">
                                    <template x-for="tag in vendor.tags">
                                        <span class="badge rounded-pill shadow-sm py-1 px-3 text-capitalize"
                                              :class="'bg-brand-' + tag"
                                              style="font-size: 0.7rem; font-weight: 500;"
                                              x-text="tag.replace(/-/g, ' ')">
                                        </span>
                                    </template>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </template>
        </div>
    </main>

    <!-- Footer Placeholder -->
    <div id="footer-placeholder"></div>

    <!-- Mobile Nav Placeholder -->
    <div id="mobile-nav-placeholder"></div>


    <!-- JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../js/script.js"></script>
    <script>
        loadComponent("#navbar-placeholder", "../components/navbar.html");
        loadComponent("#footer-placeholder", "../components/footer.html").then(() => setCopyrightYear());

    </script>
</body>

</html>