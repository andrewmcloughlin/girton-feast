<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food & Drink - Girton Feast</title>

    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="../images/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../images/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../images/favicons/favicon-16x16.png">
    <link rel="manifest" href="../images/favicons/site.webmanifest">
    <link rel="shortcut icon" href="../images/favicons/favicon.ico">

    <!-- Bootstrap CSS from CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Google Fonts: Sigmar One and Poppins -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sigmar+One&family=Poppins:wght@400;700&display=swap"
        rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <!-- Alpine.js -->
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../css/style.css">
</head>

<body class="bg-brand-glaucous" x-data x-on:keydown.window="$store.app.handleKonami($event.key)">

    <!-- Placeholder for the navigation bar -->
    <div id="navbar-placeholder"></div>

    <main class="container-xxl my-5"
          x-data="{
            vendors: [],
            selectedDiet: 'all',
            get uniqueDiets() {
                return [...new Set(this.vendors.flatMap(v => v.tags))].sort();
            },
            get filteredVendors() {
                if (this.selectedDiet === 'all') return this.vendors;
                return this.vendors.filter(v => v.tags.includes(this.selectedDiet));
            }
          }"
          x-init="vendors = await (await fetch('../vendors.json')).json()">

        <div class="row pt-2">
            <!-- Sidebar for Desktop Filters -->
            <aside class="col-lg-3 d-none d-lg-block">
                <div class="text-center mb-4">
                    <!-- header image to go here -->
                </div>
                <div class="p-4 rounded-4 shadow-sm sticky-top bg-light" style="top: 100px;">
                    <h5 class="fw-bold mb-4" style="color: var(--brand-marian-blue);">
                        <i class="fas fa-filter me-2 small"></i>Filters
                    </h5>

                    <div id="food-filters-sidebar" class="d-flex flex-column gap-2">
                        <!-- All Categories Toggle -->
                        <div class="filter-item d-flex align-items-center justify-content-between p-3 rounded-4 transition-300 cursor-pointer"
                             :class="selectedDiet === 'all' ? 'bg-brand-marian-blue text-white shadow' : 'bg-white hover-light'"
                             @click="selectedDiet = 'all'">
                            <div class="d-flex align-items-center">
                                <div class="filter-checkbox-custom me-3 rounded-circle border border-2 d-flex align-items-center justify-content-center"
                                     :class="selectedDiet === 'all' ? 'border-white bg-white-opacity-20' : 'border-secondary'">
                                    <i class="fas fa-check small" x-show="selectedDiet === 'all'"></i>
                                </div>
                                <span class="filter-label fw-bold">All Food & Drink</span>
                            </div>
                            <span class="badge rounded-pill bg-white text-dark small" x-text="vendors.length"></span>
                        </div>

                        <!-- Dynamic Tag Filters -->
                        <template x-for="diet in uniqueDiets">
                            <div class="filter-item d-flex align-items-center justify-content-between p-3 rounded-4 transition-300 text-capitalize cursor-pointer"
                                 :class="selectedDiet === diet ? 'bg-brand-marian-blue text-white shadow' : 'bg-white hover-light'"
                                 @click="selectedDiet = diet">
                                <div class="d-flex align-items-center">
                                    <div class="filter-checkbox-custom me-3 rounded-circle border border-2 d-flex align-items-center justify-content-center"
                                         :class="selectedDiet === diet ? 'border-white bg-white-opacity-20' : 'border-secondary'">
                                        <i class="fas fa-check small" x-show="selectedDiet === diet"></i>
                                    </div>
                                    <span class="filter-label fw-bold" x-text="diet.replace(/-/g, ' ')"></span>
                                </div>
                                <span class="badge rounded-pill bg-white text-dark small"
                                      x-text="vendors.filter(v => v.tags.includes(diet)).length"></span>
                            </div>
                        </template>
                    </div>
                </div>
            </aside>

            <!-- Main Content Area -->
            <div class="col-lg-9">
                <!-- Header -->
                <div class="text-center pt-5 mb-5">
                    <img src="../images/titles/food-and-drink-text.svg" alt="Food & Drink Header" class="img-fluid"
                        style="max-height: min(150px, 90vw);">
                </div>

                <div id="vendor-container" class="row g-4">
                    <template x-for="vendor in filteredVendors">
                        <div class="col-md-6 col-lg-4">
                            <div class="card border-0 shadow-sm h-100 overflow-hidden text-decoration-none hover-scale rounded-4">
                                <a :href="vendor.url !== '#' ? vendor.url : 'javascript:void(0)'"
                                   :target="vendor.url.startsWith('http') ? '_blank' : '_self'"
                                   class="text-decoration-none h-100 d-flex flex-column">
                                    <div class="ratio ratio-4x3">
                                        <img :src="'../' + vendor.image"
                                             class="card-img object-fit-cover"
                                             :alt="vendor.name">
                                    </div>
                                    <div class="card-img-overlay d-flex flex-column justify-content-end"
                                        style="background: linear-gradient(to bottom, transparent 0%, rgba(0, 0, 0, 0.8) 100%);">
                                        <h4 class="card-title fw-bold text-white mb-2" style="text-shadow: 0 2px 4px rgba(0,0,0,0.5);" x-text="vendor.name"></h4>
                                        <div class="d-flex flex-wrap gap-1">
                                            <template x-for="tag in vendor.tags">
                                                <span class="badge rounded-pill shadow-sm text-capitalize"
                                                      :class="'bg-brand-' + tag"
                                                      style="font-size: 0.65rem;"
                                                      x-text="tag.replace(/-/g, ' ')">
                                                </span>
                                            </template>
                                        </div>
                                    </div>
                                </a>
                            </div>
                        </div>
                    </template>
                </div>
            </div>
        </div>

        <!-- Floating Action Button for Mobile Filters -->
        <button class="fab-filter d-lg-none" type="button" data-bs-toggle="offcanvas"
            data-bs-target="#offcanvasFilters" aria-controls="offcanvasFilters">
            <i class="fas fa-filter"></i>
        </button>

        <!-- Offcanvas Mobile Filters -->
        <div class="offcanvas offcanvas-bottom rounded-top-4" tabindex="-1" id="offcanvasFilters"
        aria-labelledby="offcanvasFiltersLabel" style="height: auto; max-height: 85vh;">
            <div class="offcanvas-header border-bottom py-3">
                <h5 class="offcanvas-title fw-bold" id="offcanvasFiltersLabel" style="color: var(--brand-marian-blue);">
                    <i class="fas fa-sliders-h me-2"></i>Filter Food & Drink
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <div class="offcanvas-body p-4">
                <h6 class="fw-bold mb-3 text-muted small text-uppercase letter-spacing-1">Categories</h6>
                <div class="mobile-filter-grid overflow-auto pb-2" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                    <!-- All Categories Toggle -->
                    <div class="filter-item text-center p-2 rounded-3 border transition-200 cursor-pointer"
                         :class="selectedDiet === 'all' ? 'bg-brand-marian-blue text-white border-brand-marian-blue shadow-sm' : 'bg-light border-light-subtle'"
                         @click="selectedDiet = 'all'">
                        <span class="small fw-bold">All</span>
                    </div>
                    <!-- Dynamic Tag Filters -->
                    <template x-for="diet in uniqueDiets">
                        <div class="filter-item text-center p-2 rounded-3 border transition-200 text-capitalize cursor-pointer"
                             :class="selectedDiet === diet ? 'bg-brand-marian-blue text-white border-brand-marian-blue shadow-sm' : 'bg-light border-light-subtle'"
                             @click="selectedDiet = diet">
                            <span class="small fw-bold" x-text="diet.replace(/-/g, ' ')"></span>
                        </div>
                    </template>
                </div>

                <div class="mt-4 pt-2">
                    <button type="button" class="btn btn-brand-marian-blue w-100 rounded-pill py-3 fw-bold shadow-sm" data-bs-dismiss="offcanvas">
                        Show Results
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer Placeholder -->
    <div id="footer-placeholder"></div>

    <!-- Mobile Nav Placeholder -->
    <div id="mobile-nav-placeholder"></div>


    <!-- JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../js/script.js"></script>
    <script>
        loadComponent("#navbar-placeholder", "../components/navbar.html");
        loadComponent("#footer-placeholder", "../components/footer.html").then(() => setCopyrightYear());

    </script>
</body>


</html>
